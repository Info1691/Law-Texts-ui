<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Trust Law Textbooks ‚Äî Catalog</title>

  <!-- Existing styles (keep using your repo‚Äôs CSS) -->
  <link rel="stylesheet" href="./app.css">
  <link rel="stylesheet" href="./drawer.css">

  <!-- Local, minimal fixes so you don't have to edit CSS files -->
  <style>
    /* keep the header tight and consistent */
    header.bar{display:flex;align-items:center;gap:1rem;padding:.75rem 1rem;border-bottom:1px solid rgba(0,0,0,.06)}
    header.bar .brand{display:flex;align-items:center;gap:.75rem}
    header.bar .brand img{height:28px;width:auto;background:#fff;padding:.15rem .25rem;border-radius:4px;box-shadow:0 0 0 1px rgba(0,0,0,.05)}
    header.bar nav{margin-left:auto}
    header.bar nav a{display:inline-flex;align-items:center;padding:.5rem .75rem;border-radius:6px;text-decoration:none;border:1px solid rgba(0,0,0,.08)}
    .wrap{display:grid;grid-template-columns:280px minmax(0,1fr);gap:1rem;padding:1rem}
    .card{background:#fff;border-radius:10px;border:1px solid rgba(0,0,0,.08);padding:.75rem}
    .muted{color:#6b7280;font-size:.925rem}
    .group-title{font-weight:700;margin:.25rem 0 .5rem 0}
    .repo-kv{display:grid;grid-template-columns:90px minmax(0,1fr);gap:.25rem .5rem;font-size:.94rem}
    .repo-kv .k{color:#6b7280}
    .repo-kv a{color:#0b5cab;text-decoration:none}
    .repo-kv a:hover{text-decoration:underline}
    .results{display:flex;flex-direction:column;gap:.75rem}
    .item{background:#fff;border:1px solid rgba(0,0,0,.08);border-radius:12px;padding:.9rem 1rem}
    .item h3{margin:.15rem 0 .35rem 0;font-size:1.05rem}
    .filter{display:flex;gap:.5rem}
    .filter input{flex:1;min-width:0;border:1px solid rgba(0,0,0,.12);border-radius:10px;padding:.6rem .8rem}
    .filter button{border:1px solid rgba(0,0,0,.12);background:#0b5cab;color:#fff;border-radius:10px;padding:.55rem .9rem}
    .pill{display:inline-flex;align-items:center;gap:.25rem;border:1px solid rgba(0,0,0,.12);border-radius:999px;padding:.15rem .5rem;font-size:.8rem}
    /* ‚ÄúSearch (beta)‚Äù link styling (small, under This UI line) */
    .mini-link{display:inline-flex;align-items:center;gap:.4rem;margin-top:.25rem;font-size:.875rem;opacity:.9}
  </style>
</head>
<body>

<header class="bar">
  <div class="brand">
    <!-- your logo with white background applied via CSS above -->
    <img src="./logo.png" alt="Brand logo">
    <strong>Trust Law Textbooks ‚Äî Catalog</strong>
  </div>
  <nav>
    <a href="/search.html" title="Search (beta)">Search (beta)</a>
  </nav>
</header>

<main class="wrap">
  <!-- LEFT: REPOS panel -->
  <aside class="card" id="repos">
    <div class="group-title">REPOS</div>
    <div class="repo-kv">
      <div class="k">Public:</div>
      <div><a href="https://info1691.github.io/law-index/">law-index</a></div>

      <div class="k">Texts UI:</div>
      <div>Law-Texts-ui</div>

      <!-- Absolute Search (beta) link ‚Äî works from anywhere -->
      <div></div>
      <div>
        <a class="mini-link" href="/search.html">
          <span aria-hidden="true">üîé</span><span>Search (beta)</span>
        </a>
      </div>

      <div class="k">Source:</div>
      <div><a href="./texts/catalog.json">./texts/catalog.json</a></div>
    </div>

    <p class="muted" style="margin-top:.5rem">Built from the local textbooks catalog.</p>
  </aside>

  <!-- RIGHT: Catalog list + filter -->
  <section>
    <div class="card" style="margin-bottom:1rem">
      <form class="filter" data-form="filter">
        <input type="text" name="q" placeholder="Filter by title / jurisdiction / year ‚Ä¶" />
        <button type="submit">Filter</button>
      </form>
      <p class="muted" id="counts">Loading‚Ä¶</p>
    </div>

    <div class="results" id="list"></div>
  </section>
</main>

<!-- Your existing JS keeps working -->
<script src="./app.js"></script>
<script src="./catalog.js"></script>
<script src="./drawer.js"></script>
<script>
  /* Simple bootstrap: render items from texts/catalog.json if your catalog.js
     doesn‚Äôt already do this. Safe to keep even if catalog.js handles it. */
  (async () => {
    const $list = document.getElementById('list');
    const $counts = document.getElementById('counts');
    try {
      const res = await fetch('./texts/catalog.json', { cache: 'no-store' });
      const items = await res.json();
      $counts.textContent = `Loaded ${items.length} item(s).`;
      const q = new URL(location.href).searchParams.get('q')?.toLowerCase() || '';
      const filtered = q ? items.filter(it =>
        [it.title,it.jurisdiction,it.reference,(it.year||'')].join(' ').toLowerCase().includes(q)
      ) : items;

      $list.innerHTML = filtered.map(it => `
        <article class="item">
          <h3>${it.title}</h3>
          <div class="muted" style="margin-bottom:.35rem">
            ${it.jurisdiction?.toUpperCase() || ''} ${it.year ? '¬∑ ' + it.year : ''} ¬∑ ${it.reference || ''}
          </div>
          <a class="pill" href="${it.url_txt}">open TXT</a>
        </article>
      `).join('');
    } catch (e) {
      $counts.textContent = 'Failed to load catalog.';
      console.error(e);
    }
  })();
</script>
</body>
</html>
